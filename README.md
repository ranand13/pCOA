# Parameter Causal Ordering Analysis (pCOA)



> Companion code for: [Causal model for estimating outcomes of interventions on dynamical systems from
steady state observational data]  


## Overview

This repository contains code to reproduce all experiments, figures, and tables from our paper on Parameter Cancellation and Ordering Analysis (pCOA) - a method for deriving causal structures from ODE equilibrium equations to predict steady-state responses to biological perturbations.

## Repository Structure

```
.
├── mapk_ieg_cascade/              # Investigation A: MAPK-IEG cascade
│   ├── mapk_code_modules/         # Core modules for this case study
│   ├── mapk_replicate_cache_25/   # Cached parameter replicates
│   ├── figures/                   # Generated figures
│   ├── results/                   # Experimental results
│   ├── experiment_runner.ipynb    # Runs experiments, generates data
│   └── figures_and_data.ipynb     # Produces paper figures & tables
│
├── dream_hpn/                     # Investigation B: HPN-DREAM breast cancer
│   ├── dream_hpn_code_modules/    # Core modules for this case study
│   ├── dream_hpn_cache/           # Cached intermediate results
│   ├── dream_hpn_data/            # DREAM challenge data
│   ├── figures/                   # Generated figures
│   ├── results/                   # Experimental results
│   ├── experiment_runner.ipynb    # Runs experiments, generates data
│   └── figures_and_data.ipynb     # Produces paper figures & tables
│
├── ecoli_regulon/                 # Investigation C: E. coli CRP regulon
│   ├── ecoli_code_modules/        # Core modules for this case study
│   ├── ecoli_crp_data/            # E. coli PPTP-seq data
│   ├── figures/                   # Generated figures
│   ├── results/                   # Experimental results
│   ├── experiment_runner.ipynb    # Runs experiments, generates data
│   └── figures_and_data.ipynb     # Produces paper figures & tables
│
├── misc_simulations/              # Additional theoretical analyses
│   └── ...
│

└── README.md                      # This file
```

## Installation

### Prerequisites
- Python 3.8+
- Jupyter Notebook or JupyterLab

### Setup

1. Clone the repository:
```bash
git clone https://github.com/yourusername/pcoa-paper.git
cd pcoa-paper
```

2. Create a virtual environment:
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```



## Usage

Each case study follows a two-stage workflow using Jupyter notebooks:

### Stage 1: Run Experiments (Generate Data)

Open and run the `experiment_runner.ipynb` notebook in each case study folder:

```bash
# MAPK-IEG Cascade
cd mapk_ieg_cascade
jupyter notebook experiment_runner.ipynb

# HPN-DREAM Breast Cancer
cd dream_hpn
jupyter notebook experiment_runner.ipynb

# E. coli CRP Regulon
cd ecoli_regulon
jupyter notebook experiment_runner.ipynb
```

This generates raw results in the `results/` folder of each case study.

### Stage 2: Create Figures & Tables

Open and run the `figures_and_data.ipynb` notebook in each case study folder:

```bash
jupyter notebook figures_and_data.ipynb
```

This produces figures and tables in the `figures/` folder, corresponding to those in the paper.


## Data

### Included in Repository
- **MAPK-IEG**: Synthetic data generated by experiments
- **E. coli**: Processed PPTP-seq data in `ecoli_regulon/ecoli_crp_data/`

### External Data
- **HPN-DREAM**: Breast cancer phosphoproteomic data
  - Source: HPN-DREAM Challenge (Synapse)
  - Downloaded automatically on first run
  - Cached in `dream_hpn/dream_hpn_data/`

---

**Last Updated**: November 2025
